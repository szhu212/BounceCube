!function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);const s=.8,r=.8,h=.4,n=15,l=15,o=2,a=1,c=4,d=10,u=0,m=38,g=37,v=39,y={0:[[1,1,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[1,1,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[2,0,0,0,0,0,0],[0,0,0,0,0,0,0],[2,0,1,1,1,0,0]],1:[[1,1,1,1,1,0,0],[0,0,0,0,0,0,0],[1,1,0,0,0,0,0],[0,0,0,0,0,0,1],[0,0,0,0,0,1,1],[1,1,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[2,0,0,0,0,0,0],[0,0,1,1,1,0,0]]},f={0:"Level 1",1:"Level 2"},p={0:"Have Fun!",1:"Level up. Great Job!"},b={0:"255, 186, 132",1:"98, 41, 84",2:"137, 145, 107",3:"145, 180, 147",4:"102, 186, 183",5:"30, 136, 168",6:"123, 144, 210",7:"155, 144, 194",8:"238, 169, 169",9:"93, 172, 129",10:"24, 60, 138",11:"208, 16, 76",12:"253, 153, 102",13:"190, 194, 63",14:"180, 129, 187"},x=(t,e)=>!(t.left>e.right||t.right<e.left)&&!(t.top>e.bottom||t.bottom<e.top),T=(t,e)=>t.filter(t=>t===e).length;let k=firebase.database().ref("scores").orderByChild("score").limitToFirst(5);const w=[];k.on("child_added",t=>{w.push(t.val());let e=document.getElementById("high-scores");e.innerHTML="",w.sort(L),w.forEach(t=>{let i=t.name,s=t.score,r=document.createElement("p");r.innerHTML=`${i} ${s}s`,e.appendChild(r)})});const L=(t,e)=>{const i=t.score,s=e.score;let r=0;return i>s?r=1:i<s&&(r=-1),r},M=(t,e)=>{firebase.database().ref("scores").push({name:t,score:e}),document.getElementById("record-submission").innerHTML="",async function(){let t=firebase.database().ref("scores").orderByChild("score").limitToFirst(5),e=[],i=await e;t.on("child_added",t=>{e.push(t.val());let s=document.getElementById("high-scores");s.innerHTML="",i.sort(L),i.forEach(t=>{let e=t.name,i=t.score,r=document.createElement("p");r.innerHTML=`${e} ${i}s`,s.appendChild(r)})})}()};new Audio("assets/bensound-summer.mp3");class E{constructor(t,e={},i){this.dimensions=t,this.x=u,this.y=this.dimensions.height-d,this.velX=0,this.velY=0,this.keysTracker=e,this.level=i,this.collisionAdj=0}drawPlayer(t){t.fillStyle=`rgb(${this.level.color})`,t.fillRect(this.x,this.y,n,l)}updatePlayer(t){t[m]&&(this.velY-=1*o),t[g]&&(this.velX-=a),t[v]&&(this.velX+=a),this.velX*=r,this.y<390&&(this.velY+=s),this.velY>0?this.velY-=h:this.velY+=h,Math.abs(this.velX)>c&&(this.velX>0?this.velX=c:this.velX=-1*c),Math.abs(this.velY)>c&&(this.velY>0?this.velY=c:this.velY=-1*c),this.collideWithBrick()&&this.resolveCollision(),this.x+=this.velX,this.y+=this.velY,this.x>this.dimensions.width-n-u?this.x=this.dimensions.width-n-u:this.x<0&&(this.x=u),this.y>this.dimensions.height-l?this.y=this.dimensions.height-l:this.y<0&&(this.y=0)}bounds(){return{left:this.x,right:this.x+n,top:this.y,bottom:this.y+l}}animate(t,e){this.updatePlayer(e),this.drawPlayer(t)}collideWithBrick(){let t=!1;return Object.values(this.level.bricks).forEach(e=>{x(e,this.bounds())&&(t=!0)}),t}collisionDir(){let t=[null,null];const e=(e,i)=>{const s=e.right-e.left,r=i.right-i.left,h=e.bottom-e.top,n=i.bottom-i.top,l=(e.left+e.right)/2-(i.left+i.right)/2,o=(e.bottom+e.top)/2-(i.bottom+i.top)/2,a=(s+r)/2,c=(h+n)/2,d=a-Math.abs(l),u=c-Math.abs(o);Math.abs(l)<a&&Math.abs(o)<c&&(d>=u?o>0?(t[1]="top",this.collisionAdj=u):(t[1]="bottom",this.collisionAdj=-u):l<0?(t[0]="right",this.collisionAdj=-d):(t[0]="left",this.collisionAdj=d))};return Object.values(this.level.bricks).forEach(t=>{e(this.bounds(),t)}),t}resolveCollision(){this.collideWithBrick()&&("right"===this.collisionDir()[0]&&(this.x+=this.collisionAdj,0!==this.velX?this.velX*=-1:this.velX=.1),"left"===this.collisionDir()[0]&&(this.x+=this.collisionAdj,0!==this.velX?this.velX*=-1:this.velX=-.1),"top"===this.collisionDir()[1]&&(this.y+=this.collisionAdj,this.velY*=-1),"bottom"===this.collisionDir()[1]&&(this.y+=this.collisionAdj,this.velY<0&&this.velY>-2?this.velY=0:this.velY*=-1,this.bottomCollision=!0),this.collisionAdj=0)}}class j{constructor(t,e){this.dimensions=t,this.level=JSON.parse(JSON.stringify(y))[e],this.currentLevel=e,this.bricks={},this.targetLength=10,this.targets={},this.numTargets=0,this.color="0,92,175"}drawLevel(t,e){const i=this.dimensions.width/this.level[0].length,s=this.dimensions.height/this.level.length;T(this.level.flat(),1);this.numTargets=T(this.level.flat(),2);for(let r=0;r<this.level.length;r++)for(let h=0;h<this.level[0].length;h++){let n=h*i,l=r*s;if(1===this.level[r][h]){const e=new Image;e.src="./assets/brick.png",e.onload=function(){t.drawImage(e,n,l,i,s)},t.drawImage(e,n,l,i,s),this.bricks[[r,h]]={left:n,top:l,right:n+i,bottom:l+s}}else if(2===this.level[r][h]){let i;0===h&&(n+=u),r===this.level.length&&(l-=u);let s=r+","+h;i=Object.keys(this.targets).includes(s)?this.targets[[r,h]]:this.randomColor(),t.fillStyle=`rgb(${i})`,t.fillRect(n,l,this.targetLength,this.targetLength);let o={left:n,top:l,right:n+this.targetLength,bottom:l+this.targetLength,color:i};if(this.targets[[r,h]]=i,x(e.bounds(),o)){this.level[r][h]=0,this.color=o.color,document.getElementById("game-page").style.backgroundColor=`rgba(${this.color}, 0.6)`}}}}drawBackground(t){t.fillStyle="rgba(255,255,255,0.4)",t.fillRect(0,0,this.dimensions.width,this.dimensions.height)}randomColor(){let t=Math.floor(15*Math.random());return b[t]}animate(t,e){this.drawBackground(t),this.drawLevel(t,e)}}class C{constructor(t){this.ctx=t.getContext("2d"),this.canvas=t,this.dimensions={width:t.width,height:t.height},this.keysTracker={},this.running=!1,this.currentLevel=0,this.totalTarget=0,this.registerEvents(),this.restart(this.currentLevel),this.levelUp=!1,this.gameoverTracker=!1,this.scores=[],this.highestScoreMode=!1,this.playingMusic=!1}play(){this.running=!0,Object.values(this.keysTracker).length>0&&Object.values(this.keysTracker).some(t=>!0===t)&&this.animate()}restart(t){this.gameoverTracker=!1,this.levelUp||(this.running=!1),this.startTime=this.startTime||Date.now(),this.textTimer=0,this.numTargets=1,this.gameover()?(this.currentLevel=0,this.gameoverTracker=!0,this.gameoverFrame()):(this.level=new j(this.dimensions,t),this.player=new E(this.dimensions,this.keysTracker,this.level),this.totalTarget=y[this.currentLevel].flat().filter(t=>2===t).length,this.animate())}keyDownHandler(t){if(this.keysTracker[t.keyCode]=!0,this.keysTracker[82]&&!this.highestScoreMode){if(this.gameoverTracker){this.currentLevel=0,this.startTime=Date.now(),this.running=!1,document.getElementById("gameover-box").style.opacity="0"}this.restart(this.currentLevel)}else this.running||this.highestScoreMode||this.play()}keyUpHandler(t){this.keysTracker[t.keyCode]=!1}registerEvents(){this.keyDownHandler=this.keyDownHandler.bind(this),this.keyUpHandler=this.keyUpHandler.bind(this),document.addEventListener("keydown",t=>{this.keyDownHandler(t)}),document.addEventListener("keyup",t=>{this.keyUpHandler(t)})}drawTimer(){this.timer=Math.floor((Date.now()-this.startTime)/1e3),0===this.textTimer&&0===this.currentLevel&&(this.timer=0),this.ctx.font="20px Dosis",this.ctx.fillStyle="rgb(255, 255, 255)",this.ctx.fillText(""+this.timer,this.canvas.width-60,20)}drawCounter(){let t=`${this.numTargets}/${this.totalTarget}`;this.ctx.font="20px Dosis",this.ctx.fillStyle="rgb(255, 255, 255)",this.ctx.fillText(t,this.canvas.width-60,50)}animate(){this.ctx.font="Dosis",this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.level.animate(this.ctx,this.player),this.player.animate(this.ctx,this.keysTracker),this.numTargets=this.level.numTargets,this.drawTimer(),this.drawText(),this.drawCounter(),0!==this.numTargets||this.gameoverTracker||(this.currentLevel+=1,this.levelUp=!0,this.restart(this.currentLevel)),this.running&&requestAnimationFrame(this.animate.bind(this))}levelUpText(){this.textTimer+=1,this.ctx.save(),this.ctx.font="38px Dosis",this.ctx.fillStyle="white",this.ctx.strokeStyle="yellow",this.ctx.fillText(""+f[this.currentLevel],this.canvas.width/3,100),this.ctx.strokeText(""+f[this.currentLevel],this.canvas.width/3,100),this.ctx.font="28px Dosis",this.ctx.strokeStyle="skyblue",this.ctx.fillText(""+p[this.currentLevel],200,140),this.ctx.strokeText(""+p[this.currentLevel],200,140),this.ctx.restore()}drawText(){0===this.textTimer&&(this.ctx.save(),this.ctx.font="25px Dosis",this.ctx.fillStyle="rgba(255,255,255)",this.ctx.shadowColor="rgba(0,0,0,0.7)",this.ctx.shadowBlur=5,this.ctx.fillText("Press the ↑ ← → buttons on your keyboard to navigate your cube",this.canvas.width/12,2*this.canvas.height/5,5*this.canvas.width/6),this.ctx.restore()),this.textTimer<100&&0!==this.currentLevel||0===this.currentLevel&&this.textTimer<100&&this.textTimer>0?this.levelUpText():this.textTimer+=1}gameover(){return this.currentLevel>=Object.keys(y).length}gameoverFrame(){let t=this.timer;this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),document.getElementById("game-page").style.backgroundColor="orange";const e=document.getElementById("gameover-box");e.style.transition="all 1s ease-in-out;",e.style.opacity=1;let i=document.createElement("p"),s=Math.floor(this.timer/60),r=Math.floor(this.timer%60);i.innerHTML=`You spent ${s}M ${r}S to clear all the levels. Congratulations!`;const h=document.getElementById("gameover-messsage");h.innerHTML="",h.appendChild(i),document.getElementById("you-won-message").style.animation="shake 0.5s";let n=[];w.forEach(t=>{n.push(t.score)});let l=Math.max(...n),o="";if(t<l){this.highestScoreMode=!0;let e=document.getElementById("record-submission");e.innerHTML="";let i=document.createElement("p");i.innerHTML="You score is among the top 5 in our history! Please enter you name to be on our high score board ☺",e.appendChild(i);let s=document.createElement("input");s.type="text",s.placeholder="Please enter your name here",e.appendChild(s),s.addEventListener("change",t=>{o=t.currentTarget.value});let r=document.createElement("button");r.innerHTML="Submit",e.appendChild(r),r.addEventListener("click",e=>{this.highestScoreMode=!1,M(o,t)})}}}document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("game-canvas");new C(t)});const S=document.getElementById("music-button"),B=document.getElementById("music-icon"),D=new Audio("assets/bensound-summer.mp3");let H=!1;S.addEventListener("click",(function(){H?(H=!1,B.src="./assets/play-music.png",D.pause()):(H=!0,B.src="./assets/stop-music.png",D.play())}))}]);
//# sourceMappingURL=index.js.map